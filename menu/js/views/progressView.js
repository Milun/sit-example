define([],function(){class e extends Backbone.View{className(){return["progress",this.model.get("_isActive")?"is-active":""].join(" ")}events(){return{"click .js-progress-btn":"onProgressBtnClick","click .js-progress-bar-item":"onProgressBarItemClick","mouseenter .js-progress-bar-item":"onProgressBarItemMouseenter",mouseleave:"onMouseleave"}}initialize(){this.update=_.debounce(this.update.bind(this),0),this.render(),this.setupEventListeners()}setupEventListeners(){this.listenTo(this.model,{"change:_isActive":this.onActiveChange}),this.listenTo(this.model.get("_items"),{"change:_isActive":this.onItemActiveChange,"change:_isComplete":this.onItemCompleteChange}),this.$el.on("transitionend",this.onTransitionEnd.bind(this))}onProgressBarItemClick(e){e=$(e.currentTarget).attr("data-index");this.model.setActiveItem(e)}onProgressBarItemMouseenter(e){var e=$(e.currentTarget).attr("data-index"),s=this.$(".js-progress-bar-item").filter(`[data-index='${e}']`),t=$(".js-progress-preview"),i=(t.toggleClass("is-active",!0),s.offset()),s=s.width();i.left+=s/2,t.offset(i);s=t.find(".js-progress-preview-item").toggleClass("is-active",!1).filter(`[data-index='${e}']`).toggleClass("is-active",!0).find(".js-progress-preview-img");s.hasClass("is-ready")||s.attr("src",s.attr("data-src")).addClass("is-ready")}onMouseleave(e){$(".js-progress-preview").toggleClass("is-active",!1)}onProgressBtnClick(e){this.model.set("_isActive",!0)}onActiveChange(e,s){this.$el.toggleClass("is-active",s),this.update()}onItemActiveChange(e,s){s&&this.update()}update(){var e,s,t,i,r=this.model.getActiveItem();r&&(e=this.$(".js-progress-bar").width(),(i=this.$(".js-progress-bar-item").toggleClass("is-active",!1).filter(`[data-index='${r.get("_index")}']`)).toggleClass("is-active",!0),s=this.$(".js-progress-bar-cur"),t=i.position().left/e*(100/Hybrid.wrapperModel.get("_scale"))+"%",i=i.width()/e*100+"%",s.css({left:t,width:i}),s.toggleClass("is-complete",Boolean(r.get("_isComplete"))))}onItemCompleteChange(e,s){this.$(".js-progress-bar-item").filter(`[data-index=${e.get("_index")}]`).toggleClass("is-complete",s),this.$(".js-progress-bar-cur").toggleClass("is-complete",Boolean(s))}render(){var e=this.model.toJSON(),s=(e._items=e._items.toJSON(),Handlebars.templates["hm-progress"]);this.$el.html(new Handlebars.SafeString(s(e)).string),this.$el.hide(0).show(0),this.update()}onTransitionEnd(e){$(e.currentTarget).is(this.$el)&&this.update()}}return e});